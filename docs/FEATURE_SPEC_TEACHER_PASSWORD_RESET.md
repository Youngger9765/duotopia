# 功能規格：教師註冊、密碼重設與訂閱系統

## 📋 功能總覽
**分支名稱**: `feature/teacher-trial-subscription-system`
**版本**: v1.0.0
**最後更新**: 2025-09-22

## 🎯 新增功能說明

### 1. 教師註冊與驗證
新教師註冊後需要驗證 Email，驗證成功自動獲得 30 天試用期。

### 2. 忘記密碼功能
教師可以透過 Email 重設密碼，不需要聯繫客服。

### 3. 測試帳號系統
提供三種不同狀態的測試帳號，方便演示不同訂閱狀態下的系統表現。

### 4. 訂閱模擬測試
Demo 帳號專屬功能，可以快速切換不同訂閱狀態來測試系統功能。

---

## 🧪 測試步驟說明

### A. 教師註冊與Email驗證測試

#### 步驟 1：註冊新教師帳號
1. 打開教師註冊頁面
2. 填寫資料：
   - 姓名
   - Email（使用真實可收信的信箱）
   - 密碼（至少 6 個字元）
3. 勾選同意服務條款
4. 點擊「註冊」按鈕
5. 系統會顯示「請查收驗證郵件」的提示

#### 步驟 2：驗證 Email
1. 檢查您的信箱，會收到驗證郵件
2. 郵件標題：「Duotopia - 請驗證您的 Email」
3. 點擊郵件中的「驗證 Email」按鈕
4. 或複製驗證連結到瀏覽器開啟
5. 驗證成功後會顯示：
   - ✅ Email 驗證成功
   - 🎁 獲得 30 天免費試用
6. 點擊「前往登入」即可開始使用

#### 注意事項
- 驗證連結 24 小時內有效
- 驗證成功自動獲得 30 天試用期
- 未驗證的帳號無法登入使用

---

### B. 密碼重設功能測試

#### 步驟 1：進入忘記密碼頁面
1. 打開教師登入頁面
2. 點擊「忘記密碼？」連結
3. 會跳轉到忘記密碼頁面

#### 步驟 2：申請密碼重設
1. 輸入教師 Email（例如：demo@duotopia.com）
2. 點擊「發送重設連結」按鈕
3. 系統會顯示「郵件已發送」的成功訊息
4. 檢查您的信箱，會收到密碼重設郵件

#### 步驟 3：重設密碼
1. 打開郵件，點擊「重設密碼」按鈕
2. 或複製郵件中的連結，在瀏覽器開啟
3. 輸入新密碼（至少 6 個字元）
4. 確認新密碼
5. 點擊「重設密碼」
6. 成功後會顯示綠色勾勾，可以用新密碼登入

#### 注意事項
- 同一個 Email 每 5 分鐘只能申請一次重設
- 重設連結 2 小時後會過期
- 為了安全，即使輸入不存在的 Email 也會顯示成功訊息

---

### C. 快速測試登入

在登入頁面提供三個快速測試按鈕，點擊即可自動填入帳號密碼：

| 按鈕 | 帳號 | 密碼 | 訂閱狀態 | 用途 |
|------|------|------|---------|------|
| 🟢 Demo 教師 | demo@duotopia.com | demo123 | 已充值 300 天 | 測試正常訂閱功能 |
| 🔵 試用教師 | trial@duotopia.com | demo123 | 30 天試用期 | 測試試用期功能 |
| 🔴 過期教師 | expired@duotopia.com | demo123 | 已過期 | 測試過期限制功能 |

---

### D. 訂閱模擬測試（僅限 demo 帳號）

#### 進入方式
1. 使用 demo@duotopia.com 登入
2. 在教師儀表板會看到紫色按鈕「模擬訂閱充值（測試用）」
3. 點擊進入訂閱模擬頁面

#### 可測試的操作

**充值測試**
- 充值 30 天：模擬月訂閱
- 充值 90 天：模擬季訂閱
- 充值 180 天：模擬半年訂閱
- 充值 365 天：模擬年訂閱

**狀態切換**
- 設為過期：立即將訂閱設為過期狀態
- 設為試用：重設為 30 天試用期

#### 測試效果
- 充值後可以看到剩餘天數增加
- 過期後無法指派新作業
- 所有變更會立即生效

---

## 📊 系統行為說明

### 訂閱狀態對功能的影響

| 功能 | 訂閱中 | 已過期 |
|------|--------|--------|
| 查看班級 | ✅ 可以 | ✅ 可以 |
| 查看學生 | ✅ 可以 | ✅ 可以 |
| 指派新作業 | ✅ 可以 | ❌ 不可 |
| 批改作業 | ✅ 可以 | ✅ 可以 |
| 新增學生 | ✅ 可以 | ❌ 不可 |
| 建立班級 | ✅ 可以 | ❌ 不可 |

### 試用期特別說明
- 新註冊教師自動獲得 30 天試用期
- 試用期間享有完整功能
- 試用期結束後需要充值才能繼續使用

---

## ✅ 測試確認清單

請依序測試以下項目：

### 註冊與驗證
- [ ] 可以成功註冊新帳號
- [ ] 收到驗證郵件
- [ ] 驗證連結可以正常使用
- [ ] 驗證成功獲得 30 天試用期
- [ ] 未驗證帳號無法登入

### 密碼重設
- [ ] 可以成功發送重設郵件
- [ ] 重設連結可以正常使用
- [ ] 新密碼可以成功登入
- [ ] 舊密碼無法登入
- [ ] 5 分鐘內重複申請會被拒絕

### 快速登入
- [ ] Demo 教師按鈕可以快速登入
- [ ] 試用教師按鈕可以快速登入
- [ ] 過期教師按鈕可以快速登入
- [ ] 登入後顯示正確的訂閱狀態

### 訂閱模擬（demo 帳號）
- [ ] 充值功能正常運作
- [ ] 設為過期功能正常
- [ ] 設為試用功能正常
- [ ] 狀態變更後立即生效
- [ ] 非 demo 帳號無法使用此功能

---

## 🔔 重要提醒

1. **Email 發送功能**
   - 系統會真實發送郵件到您的信箱
   - 請檢查垃圾郵件資料夾（郵件可能被歸類為垃圾郵件）

2. **測試帳號保護**
   - 訂閱模擬功能僅限 demo@duotopia.com 使用
   - 其他測試帳號無法使用此功能

3. **資料安全**
   - 密碼重設連結使用一次就會失效
   - 連結有 2 小時的有效期限

---

## 📝 常見問題

**Q: 為什麼收不到密碼重設郵件？**
A: 請檢查垃圾郵件資料夾，郵件可能被歸類為垃圾郵件。如果還是找不到，請確認輸入的 Email 是否正確。

**Q: 為什麼顯示「請稍後再試」？**
A: 同一個 Email 每 5 分鐘只能申請一次密碼重設，請稍等後再試。

**Q: 訂閱模擬的改動會保存嗎？**
A: 會的，所有改動都會保存到資料庫，重新登入後狀態會保持。

**Q: 為什麼我看不到「模擬訂閱充值」按鈕？**
A: 這個按鈕只有 demo@duotopia.com 帳號登入時才會顯示。

---

**文檔版本**: 1.0.0
**作者**: Claude Code + Young
**創建日期**: 2025-09-22
**最後更新**: 2025-09-22
