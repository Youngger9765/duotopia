# 例句集 (EXAMPLE_SENTENCES) UI 設計規格

**版本**: 2.0
**更新日期**: 2025-12-10

---

## 目錄

1. [功能概述](#功能概述)
2. [例句朗讀模式 (Reading)](#例句朗讀模式-reading)
3. [例句重組模式 (Rearrangement)](#例句重組模式-rearrangement)
4. [前端組件對應](#前端組件對應)

---

## 功能概述

### ContentType 資訊

| 項目 | 說明 |
|------|------|
| ContentType | `EXAMPLE_SENTENCES` |
| 中文名稱 | 例句集 |
| 目前狀態 | ✅ Phase 1 啟用 |

### 作答模式

| 模式 | 英文代碼 | 說明 | 分數分類 |
|------|---------|------|----------|
| 例句朗讀 | `reading` | 學生朗讀句子，AI 評分 | 口說 (speaking) |
| 例句重組 | `rearrangement` | 學生排列打亂的單字 | 視音檔設定（聽力/寫作） |

### 分數分類對應

| 作答模式 | 播放音檔 | 記錄至分類 |
|---------|---------|----------|
| 例句朗讀 | N/A | 口說 (speaking) |
| 例句重組 | ✅ 是 | 聽力 (listening) |
| 例句重組 | ❌ 否 | 寫作 (writing) |

---

## 例句朗讀模式 (Reading)

### 組件

`frontend/src/components/activities/ReadingAssessmentTemplate.tsx`

### UI 佈局

```
┌─────────────────────────────────────────────────────────────┐
│ 第 1 題 / 共 5 題                                    [20%]  │ ← 進度條
├─────────────────────────────────────────────────────────────┤
│                                                             │
│ ┌─────────────────────────────────────────────────────┐    │
│ │                                                     │    │
│ │     I eat an apple every day.                       │    │ ← 朗讀文本（大字）
│ │                                                     │    │
│ │     我每天吃一個蘋果。                               │    │ ← 中文翻譯
│ │                                                     │    │
│ │     [🔊 播放示範]                                    │    │ ← 示範音檔（如有）
│ │                                                     │    │
│ └─────────────────────────────────────────────────────┘    │
│                                                             │
│                    ┌───────────────┐                        │
│                    │               │                        │
│                    │   🎤 錄音     │                        │ ← 錄音按鈕（紅色）
│                    │               │                        │
│                    └───────────────┘                        │
│                                                             │
│                    ⏱️ 剩餘時間: 0:45                         │ ← 計時器
│                                                             │
├─────────────────────────────────────────────────────────────┤
│                    AI 評分結果                               │
│  ┌─────────┬─────────┬─────────┬─────────┐                 │
│  │ 準確率  │ 流暢度  │ 發音    │ 總分    │                 │
│  │   85    │   90    │   88    │   87    │                 │
│  └─────────┴─────────┴─────────┴─────────┘                 │
└─────────────────────────────────────────────────────────────┘
```

### 計分方式

使用 Azure Speech API 進行 AI 評分：

| 維度 | 欄位 | 分數範圍 | 說明 |
|------|------|---------|------|
| 準確率 | `accuracy_score` | 0-100 | 單字發音正確程度 |
| 流暢度 | `fluency_score` | 0-100 | 語句連貫程度 |
| 發音 | `pronunciation_score` | 0-100 | 發音標準程度 |
| 完整度 | `completeness_score` | 0-100 | 句子完整程度 |

**總分計算**:
```
overall_score = (accuracy + fluency + pronunciation) / 3
```

### 互動流程

1. 顯示朗讀文本和中文翻譯
2. 可播放示範音檔（如有）
3. 學生點擊錄音按鈕開始錄音
4. 錄音完成後上傳至 GCS
5. 調用 Azure Speech API 評分
6. 顯示 AI 評分結果
7. 進入下一題或提交作業

---

## 例句重組模式 (Rearrangement)

### 組件

`frontend/src/components/activities/RearrangementActivity.tsx`

### UI 佈局

```
┌─────────────────────────────────────────────────────────────┐
│ 第 3 題 / 共 10 題                     預期分數: 88 / 100   │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  ┌──────────────────────────────────────────────────────┐   │
│  │  ⏱️ 剩餘時間: 0:25                                    │   │ ← 計時器
│  │                                                      │   │
│  │  [🔊 播放音檔]  ← 聽力模式時顯示                       │   │
│  │                                                      │   │
│  │  我每天吃一個蘋果。  ← 中文翻譯（寫作模式顯示）        │   │
│  └──────────────────────────────────────────────────────┘   │
│                                                             │
│  ✅ 已選擇的單字：                                          │
│  ┌──────────────────────────────────────────────────────┐   │
│  │  ┌─────┐ ┌─────┐ ┌─────┐                             │   │
│  │  │  I  │ │ eat │ │ an  │    [?] [?] [?] [?]          │   │ ← 答案區
│  │  └─────┘ └─────┘ └─────┘                             │   │
│  │                                                      │   │
│  │  已選擇 3 / 7 個單字                                  │   │
│  └──────────────────────────────────────────────────────┘   │
│                                                             │
│  🎯 請選擇單字：                                            │
│  ┌───────┐ ┌───────┐ ┌───────┐ ┌───────┐                   │
│  │ every │ │  day  │ │ apple │ │   .   │  ← 單字選擇區     │
│  └───────┘ └───────┘ └───────┘ └───────┘                   │
│                                                             │
│  錯誤次數: 1 / 3                                            │
└─────────────────────────────────────────────────────────────┘
```

### 計分方式

```
每題總分 = 100 分
每個單字分數 = floor(100 / 句子單字數量)

範例：7 個單字的句子
- 每個單字分數 = floor(100/7) = 14 分
- 選錯一次扣 14 分
```

### 錯誤次數限制

| 句子長度 | 允許錯誤次數 |
|---------|------------|
| 2-10 個單字 | 3 次 |
| 11-25 個單字 | 5 次 |

### 挑戰失敗處理

當錯誤次數達到上限時：
- 顯示「挑戰失敗」對話框
- **重新挑戰**: 分數歸零，重新開始
- **繼續完成**: 保持當前分數繼續作答
- **顯示答案**: 顯示正確答案（該題最高 60 分）

### 互動流程

1. 顯示打亂的單字選項
2. 聽力模式：自動播放音檔，可重播
3. 寫作模式：顯示中文翻譯
4. 學生依序點選單字組成句子
5. 即時驗證：正確則加入答案區，錯誤則提示
6. 完成所有單字後自動進入下一題
7. 全部完成後計算總分

### 視覺設計

#### 聽力模式 vs 寫作模式

| 元素 | 聽力模式 | 寫作模式 |
|------|---------|---------|
| 音檔播放 | ✅ 自動播放 + 重播按鈕 | ❌ 不播放 |
| 中文翻譯 | ❌ 不顯示 | ✅ 顯示 |
| 主題色 | 紫色 `bg-purple-50` | 藍色 `bg-blue-50` |

#### 單字按鈕狀態

| 狀態 | 樣式 |
|------|------|
| 預設 | 白色背景，灰色邊框 |
| Hover | 藍色背景 `bg-blue-50`，藍色邊框 |
| 已選擇 | 綠色背景 `bg-green-100`，綠色邊框 |
| 禁用 | 灰色背景，透明度降低 |

---

## 前端組件對應

| 作答模式 | 組件路徑 |
|---------|---------|
| 例句朗讀 | `frontend/src/components/activities/ReadingAssessmentTemplate.tsx` |
| 例句重組 | `frontend/src/components/activities/RearrangementActivity.tsx` |

### 路由判斷邏輯

位置: `frontend/src/pages/student/StudentActivityPageContent.tsx`

```typescript
// 根據 practice_mode 選擇組件
if (practiceMode === "rearrangement") {
  // → RearrangementActivity
} else {
  // → ReadingAssessmentTemplate (預設)
}
```

---

## 相關文件

- [CONTENT_TYPES.md](./CONTENT_TYPES.md) - Content Type 系統架構
- [VOCABULARY_SET_UI_PLAN.md](./VOCABULARY_SET_UI_PLAN.md) - 單字集 UI 規劃（Phase 2）
