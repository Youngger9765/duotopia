# å‰ç«¯æ•™æé¸æ“‡ç°¡åŒ–æ–¹æ¡ˆ

**æ–¹æ¡ˆåç¨±**: æ´¾ç™¼ä½œæ¥­ä»‹é¢ï¼šç§»é™¤å­¸æ ¡æ•™æ + æ–°å¢æ©Ÿæ§‹æ•™æ  
**è©•ä¼°æ—¥æœŸ**: 2026-02-10  
**æ–¹æ¡ˆé¡å‹**: âœ… å‰ç«¯å±¤ç´šè®Šæ›´ï¼ˆéç ´å£æ€§ï¼‰  
**ç›¤é»ç‹€æ…‹**: âœ… é›™æ–¹ç›¤é»å®Œæˆï¼Œçµæœä¸€è‡´

---

## ğŸ“‘ ç›®éŒ„

- [æ–¹æ¡ˆæ‘˜è¦](#-æ–¹æ¡ˆæ‘˜è¦) - æ ¸å¿ƒè®Šæ›´èˆ‡å„ªå‹¢è©•ä¼°
- [è®Šæ›´ç›®æ¨™](#-è®Šæ›´ç›®æ¨™) - æ¥­å‹™é‚è¼¯èˆ‡ä½¿ç”¨è€…é«”é©—
- [æŠ€è¡“å¯¦æ–½ç´°ç¯€](#-æŠ€è¡“å¯¦æ–½ç´°ç¯€)
  - [å®Œæ•´å½±éŸ¿ç¯„åœç›¤é»](#-å®Œæ•´å½±éŸ¿ç¯„åœç›¤é») - 7 å€‹ä½ç½®è©³ç´°æ¸…å–®
  - [ç›¤é»æ¯”å°çµæœ](#-ç›¤é»æ¯”å°çµæœ) - ä½¿ç”¨è€… vs ç³»çµ±ç›¤é»
  - [å¯¦æ–½ç­–ç•¥é¸æ“‡](#å¯¦æ–½ç­–ç•¥é¸æ“‡) - MVP vs å®Œæ•´æ–¹æ¡ˆ
  - [è©³ç´°è®Šæ›´æ¸…å–®](#è©³ç´°è®Šæ›´æ¸…å–®) - é€è¡Œç¨‹å¼ç¢¼å°ç…§
- [WorkspaceContext éœ€æ±‚](#-éœ€è¦æ–°å¢çš„-props) - è³‡æ–™çµæ§‹ç¢ºèª
- [æ¸¬è©¦è¨ˆç•«](#-æ¸¬è©¦è¨ˆåŠƒ) - å®Œæ•´æ¸¬è©¦æ¸…å–®
- [å¯¦æ–½è¨ˆç•«](#-å¯¦æ–½è¨ˆç•«) - MVP vs å®Œæ•´æ–¹æ¡ˆæ™‚ç¨‹
- [UI/UX æ”¹å–„](#-uiux-æ”¹å–„é‡é») - åœ–ç¤ºèˆ‡æ–‡æ¡ˆå„ªåŒ–
- [æ³¨æ„äº‹é …](#ï¸-æ³¨æ„äº‹é …) - APIã€æ¬Šé™ã€ç›¸å®¹æ€§
- [æœªä¾†å„ªåŒ–](#-æœªä¾†å„ªåŒ–å»ºè­°) - çŸ­ä¸­é•·æœŸè¦åŠƒ
- [æ±ºç­–å»ºè­°](#-æ±ºç­–å»ºè­°èˆ‡ç›¤é»ç¸½çµ) - åŸ·è¡Œå»ºè­°èˆ‡æˆåŠŸæŒ‡æ¨™

---

## ğŸ“Š æ–¹æ¡ˆæ‘˜è¦

### æ ¸å¿ƒè®Šæ›´

- âŒ **ç§»é™¤**: æ´¾ç™¼ä½œæ¥­æ™‚çš„ã€Œå­¸æ ¡æ•™æã€é¸é …
- âœ… **æ–°å¢**: æ´¾ç™¼ä½œæ¥­æ™‚çš„ã€Œæ©Ÿæ§‹æ•™æã€é¸é …
- âœ… **ä¿ç•™**: å¾Œç«¯æ‰€æœ‰ API å’Œæ•¸æ“šçµæ§‹ï¼ˆé›¶ç ´å£ï¼‰

### å„ªå‹¢è©•ä¼°

| è©•ä¼°ç¶­åº¦       | æ­¤æ–¹æ¡ˆ                   | å®Œå…¨ç§»é™¤æ–¹æ¡ˆ      |
| -------------- | ------------------------ | ----------------- |
| **é–‹ç™¼æˆæœ¬**   | â­â­â­â­â­ æ¥µä½ (1-2 å¤©) | â­â­ é«˜ (8-12 å¤©) |
| **é¢¨éšªç­‰ç´š**   | â­â­â­â­â­ æ¥µä½          | â­ é«˜é¢¨éšª         |
| **æ•¸æ“šå½±éŸ¿**   | â­â­â­â­â­ é›¶å½±éŸ¿        | â­ éœ€è¦é·ç§»       |
| **å‘å¾Œç›¸å®¹**   | â­â­â­â­â­ å®Œå…¨ç›¸å®¹      | â­ ç ´å£æ€§è®Šæ›´     |
| **ä½¿ç”¨è€…é«”é©—** | â­â­â­â­ æ”¹å–„            | â­â­ éœ€é©æ‡‰       |

**æ¨è–¦æŒ‡æ•¸**: â­â­â­â­â­ **å¼·çƒˆæ¨è–¦**

---

## ğŸ¯ è®Šæ›´ç›®æ¨™

### æ¥­å‹™é‚è¼¯

**è®Šæ›´å‰çš„æ´¾ç™¼ä½œæ¥­æµç¨‹**:

```
è€å¸«é€²å…¥ç­ç´š â†’ é»æ“Šã€Œæ´¾ç™¼ä½œæ¥­ã€â†’ é¸æ“‡æ•™æä¾†æºï¼š
â”œâ”€ å€‹äººæ•™æï¼ˆè€å¸«è‡ªå·±çš„æ¨¡æ¿æ•™æï¼‰
â”œâ”€ å­¸æ ¡æ•™æï¼ˆæœ¬æ ¡å°ˆå±¬æ•™æï¼‰âš ï¸ é è¨ˆç§»é™¤
â””â”€ ç­ç´šèª²ç¨‹ï¼ˆæœ¬ç­å·²è¤‡è£½çš„æ•™æï¼‰
```

**è®Šæ›´å¾Œçš„æ´¾ç™¼ä½œæ¥­æµç¨‹**:

```
è€å¸«é€²å…¥ç­ç´š â†’ é»æ“Šã€Œæ´¾ç™¼ä½œæ¥­ã€â†’ é¸æ“‡æ•™æä¾†æºï¼š
â”œâ”€ å€‹äººæ•™æï¼ˆè€å¸«è‡ªå·±çš„æ¨¡æ¿æ•™æï¼‰
â”œâ”€ æ©Ÿæ§‹æ•™æï¼ˆæ‰€å±¬æ©Ÿæ§‹çš„å…±äº«æ•™æï¼‰âœ¨ æ–°å¢
â””â”€ ç­ç´šèª²ç¨‹ï¼ˆæœ¬ç­å·²è¤‡è£½çš„æ•™æï¼‰
```

### ä½¿ç”¨è€…é«”é©—æ”¹å–„

1. **ç°¡åŒ–èªçŸ¥è² æ“”**
   - åŸæœ¬: å€‹äºº vs å­¸æ ¡ vs ç­ç´šï¼ˆä¸‰å€‹å±¤ç´šï¼‰
   - æ”¹ç‚º: å€‹äºº vs æ©Ÿæ§‹ vs ç­ç´šï¼ˆæ›´æ¸…æ™°çš„å±¤ç´šï¼‰

2. **çµ±ä¸€æ•™æä¾†æº**
   - æ©Ÿæ§‹æ•™æ = æ‰€æœ‰åˆ†æ ¡å…±ç”¨
   - é¿å…å„å­¸æ ¡å»ºç«‹é‡è¤‡æ•™æ

3. **æ›´ç¬¦åˆå¯¦éš›ä½¿ç”¨æƒ…å¢ƒ**
   - å¤§éƒ¨åˆ†æƒ…æ³ä¸‹ï¼Œæ•™ææ˜¯æ©Ÿæ§‹çµ±ä¸€ç®¡ç†
   - å­¸æ ¡å±¤ç´šçš„æ•™æéœ€æ±‚è¼ƒå°‘

---

## ğŸ”§ æŠ€è¡“å¯¦æ–½ç´°ç¯€

### ğŸ“‹ å®Œæ•´å½±éŸ¿ç¯„åœç›¤é»

#### æ ¸å¿ƒè®Šæ›´ä½ç½®ï¼ˆå¿…é ˆä¿®æ”¹ï¼‰ğŸ”´

##### 1. æŒ‡æ´¾ä½œæ¥­å°è©±æ¡† - AssignmentDialog.tsx

**URL**: `https://duotopia.co/teacher/classroom/70` > æŒ‡æ´¾æ–°ä½œæ¥­  
**æª”æ¡ˆ**: `frontend/src/components/AssignmentDialog.tsx`  
**å½±éŸ¿è¡Œæ•¸**: Line 258, 267-273, 322-324, 438-477, 1220-1250, 1498-1580

**è®Šæ›´å…§å®¹**:

- å°‡ã€Œå­¸æ ¡æ•™æã€Tab æ”¹ç‚ºã€Œæ©Ÿæ§‹æ•™æã€
- ä¿®æ”¹ API å‘¼å«å¾ `scope=school` æ”¹ç‚º `/api/organizations/{id}/programs`
- æ›´æ–°è¼‰å…¥é‚è¼¯ã€ç‹€æ…‹ç®¡ç†ã€UI å…ƒä»¶

##### 2. å­¸æ ¡è©³æƒ…é  - SchoolDetailPage.tsx

**URL**: `https://duotopia.co/organization/schools/{id}`  
**æª”æ¡ˆ**: `frontend/src/pages/organization/SchoolDetailPage.tsx`  
**å½±éŸ¿è¡Œæ•¸**: Line 368-386

**è®Šæ›´å…§å®¹**:

- ç§»é™¤æ•´å€‹ã€Œå­¸æ ¡æ•™æã€Card æŒ‰éˆ•
- ä¸å†å°èˆªè‡³ `/organization/schools/${schoolId}/materials`

##### 3. è€å¸«å´é‚Šæ¬„ - sidebarConfig.tsx

**URL**: `https://duotopia.co/teacher/dashboard` > å´é‚Šæ¬„é¸å–®  
**æª”æ¡ˆ**: `frontend/src/config/sidebarConfig.tsx`  
**å½±éŸ¿è¡Œæ•¸**: Line 64-67

**è®Šæ›´å…§å®¹**:

- å°‡ã€Œå­¸æ ¡æ•™æã€æ”¹ç‚ºã€Œæ©Ÿæ§‹æ•™æã€
- å»ºè­°æ›´æ–°åœ–ç¤ºå¾ `BookOpen` æ”¹ç‚º `Building2`
- è·¯å¾‘å¾ `/teacher/school-materials` æ”¹ç‚º `/teacher/organization-materials`

#### é€£å¸¶å½±éŸ¿ä½ç½®ï¼ˆå»ºè­°ä¿®æ”¹ï¼‰ğŸŸ¡

##### 4. è€å¸«å­¸æ ¡æ•™æé é¢ - SchoolMaterialsPage.tsx

**æª”æ¡ˆ**: `frontend/src/pages/teacher/SchoolMaterialsPage.tsx`  
**æ±ºç­–**: æ•´å€‹é é¢æ”¹ç‚ºé¡¯ç¤ºæ©Ÿæ§‹æ•™ææˆ–ç§»é™¤

**é¸é …**:

- A) é‡æ§‹ç‚ºæ©Ÿæ§‹æ•™æé é¢ï¼ˆæ¨è–¦ï¼‰
- B) å®Œå…¨ç§»é™¤ä¸¦é‡å®šå‘

##### 5. è·¯ç”±å®šç¾© - App.tsx å’Œ organizationRoutes.tsx

**æª”æ¡ˆ A**: `frontend/src/App.tsx` (Line 22, 205-209)  
**æª”æ¡ˆ B**: `frontend/src/routes/organizationRoutes.tsx` (Line 10, 77-78)

**è®Šæ›´å…§å®¹**:

- ç§»é™¤æˆ–é‡å®šå‘ `/teacher/school-materials` è·¯ç”±
- ç§»é™¤æˆ–é‡å®šå‘ `/organization/schools/:schoolId/materials` è·¯ç”±
- æ›´æ–° import èªå¥

##### 6. è€å¸«ä½ˆå±€éæ¿¾é‚è¼¯ - TeacherLayout.tsx

**æª”æ¡ˆ**: `frontend/src/components/TeacherLayout.tsx`  
**å½±éŸ¿è¡Œæ•¸**: Line 107, 128-133

**è®Šæ›´å…§å®¹**:

- æ›´æ–°éæ¿¾é‚è¼¯å¾ `school-materials` æ”¹ç‚º `org-materials`
- æ›´æ–°ç›¸é—œè¨»è§£

#### æ–‡æ¡ˆæ¸…ç†ä½ç½®ï¼ˆæ¬¡è¦å„ªåŒ–ï¼‰ğŸŸ¢

##### 7. å…¶ä»–çµ„ä»¶ä¸­çš„æ–‡å­—å¼•ç”¨

- `CreateProgramDialog.tsx` - Line 82, 165, 187, 551
- `ClassroomMaterialsSidebar.tsx` - Line 111, 183
- `SchoolProgramCreateDialog.tsx` - Line 137, 177
- `LessonDialog.tsx` - Line 34, 99, 130 (è¨»è§£)

**è®Šæ›´å…§å®¹**: å°‡æç¤ºæ–‡å­—å¾ã€Œå­¸æ ¡æ•™æã€æ”¹ç‚ºã€Œæ©Ÿæ§‹æ•™æã€

---

### ğŸ“Š ç›¤é»æ¯”å°çµæœ

| #   | ä½ç½®èªªæ˜           | ä½¿ç”¨è€…ç›¤é» | ç³»çµ±ç›¤é» | ä¸€è‡´æ€§   | å„ªå…ˆç´š |
| --- | ------------------ | ---------- | -------- | -------- | ------ |
| 1   | æŒ‡æ´¾ä½œæ¥­å°è©±æ¡†     | âœ…         | âœ…       | **ä¸€è‡´** | ğŸ”´ P0  |
| 2   | å­¸æ ¡è©³æƒ…é æŒ‰éˆ•     | âœ…         | âœ…       | **ä¸€è‡´** | ğŸ”´ P0  |
| 3   | è€å¸«å´é‚Šæ¬„é¸å–®     | âœ…         | âœ…       | **ä¸€è‡´** | ğŸ”´ P0  |
| 4   | å­¸æ ¡æ•™æé é¢       | -          | âœ…       | è£œå……     | ğŸŸ¡ P1  |
| 5   | è·¯ç”±å®šç¾© (2è™•)     | -          | âœ…       | è£œå……     | ğŸŸ¡ P1  |
| 6   | TeacherLayout éæ¿¾ | -          | âœ…       | è£œå……     | ğŸŸ¡ P1  |
| 7   | å…¶ä»–æ–‡å­—/è¨»è§£      | -          | âœ…       | è£œå……     | ğŸŸ¢ P2  |

**çµè«–**: æ ¸å¿ƒ 3 å€‹ä½ç½®å®Œå…¨ä¸€è‡´ âœ…ï¼Œå¦å¤–ç™¼ç¾ 4 å€‹é€£å¸¶å½±éŸ¿ä½ç½®éœ€è¦è™•ç†ã€‚

---

### å¯¦æ–½ç­–ç•¥é¸æ“‡

#### é¸é … A: æœ€å°å¯è¡Œæ–¹æ¡ˆï¼ˆMVPï¼‰â­â­â­â­

**ç¯„åœ**: åªä¿®æ”¹æ ¸å¿ƒ 3 å€‹ä½ç½®

- âœ… AssignmentDialog.tsx
- âœ… SchoolDetailPage.tsx
- âœ… sidebarConfig.tsx

**å„ªé»**: å¿«é€Ÿä¸Šç·šï¼Œé¢¨éšªæœ€ä½  
**ç¼ºé»**: ç•™ä¸‹æ­»è·¯ç”±å’Œæœªä½¿ç”¨çš„é é¢  
**é ä¼°æ™‚é–“**: 2-3 å°æ™‚

#### é¸é … B: å®Œæ•´æ–¹æ¡ˆï¼ˆæ¨è–¦ï¼‰â­â­â­â­â­

**ç¯„åœ**: ä¿®æ”¹å…¨éƒ¨ 7 å€‹ä½ç½®

- æ ¸å¿ƒ 3 è™•ï¼ˆP0ï¼‰
- è·¯ç”±å’Œé é¢é‡æ§‹ï¼ˆP1ï¼‰
- éæ¿¾é‚è¼¯æ›´æ–°ï¼ˆP1ï¼‰
- æ–‡æ¡ˆæ¸…ç†ï¼ˆP2ï¼‰

**å„ªé»**: å¾¹åº•è§£æ±ºï¼Œç„¡æŠ€è¡“å‚µ  
**ç¼ºé»**: é–‹ç™¼æ™‚é–“è¼ƒé•·  
**é ä¼°æ™‚é–“**: 4-6 å°æ™‚

---

### å½±éŸ¿ç¯„åœç¸½çµ

**å®Œå…¨ä¸éœ€è¦ä¿®æ”¹**:

- âœ… Backend API (é›¶è®Šæ›´)
- âœ… Database Schema (é›¶è®Šæ›´)
- âœ… æ¸¬è©¦æª”æ¡ˆ (é›¶è®Šæ›´)

### è©³ç´°è®Šæ›´æ¸…å–®

#### 1. ä¿®æ”¹ Tab é¡¯ç¤ºé‚è¼¯

**ä½ç½®**: `AssignmentDialog.tsx` Line 268

**Before**:

```typescript
const showSchoolTab = mode === "organization" && selectedSchool !== null;
```

**After**:

```typescript
const showOrganizationTab =
  mode === "organization" && selectedOrganization !== null;
```

#### 2. ä¿®æ”¹ç‹€æ…‹ç®¡ç†

**ä½ç½®**: `AssignmentDialog.tsx` Line 258, 273

**Before**:

```typescript
const [loadingSchoolPrograms, setLoadingSchoolPrograms] = useState(false);
const [schoolPrograms, setSchoolPrograms] = useState<Program[]>([]);
```

**After**:

```typescript
const [loadingOrganizationPrograms, setLoadingOrganizationPrograms] =
  useState(false);
const [organizationPrograms, setOrganizationPrograms] = useState<Program[]>([]);
```

#### 3. ä¿®æ”¹ API å‘¼å«å‡½æ•¸

**ä½ç½®**: `AssignmentDialog.tsx` Line 439-477

**Before**:

```typescript
const loadSchoolPrograms = async () => {
  if (!selectedSchool) return;

  try {
    setLoadingSchoolPrograms(true);
    const params = new URLSearchParams();
    params.append("school_id", selectedSchool.id);
    params.append("scope", "school");

    const response = await apiClient.get<Program[]>(
      `/api/teachers/programs?${params.toString()}`,
    );

    setSchoolPrograms(response);
  } catch (error) {
    console.error("Failed to load school programs:", error);
    toast.error("è¼‰å…¥å­¸æ ¡æ•™æå¤±æ•—");
    setSchoolPrograms([]);
  } finally {
    setLoadingSchoolPrograms(false);
  }
};
```

**After**:

```typescript
const loadOrganizationPrograms = async () => {
  if (!selectedOrganization) return;

  try {
    setLoadingOrganizationPrograms(true);

    // ä½¿ç”¨æ©Ÿæ§‹å°ˆå±¬çš„ API ç«¯é»
    const response = await apiClient.get<Program[]>(
      `/api/organizations/${selectedOrganization.id}/programs`,
    );

    setOrganizationPrograms(response);
  } catch (error) {
    console.error("Failed to load organization programs:", error);
    toast.error("è¼‰å…¥æ©Ÿæ§‹æ•™æå¤±æ•—");
    setOrganizationPrograms([]);
  } finally {
    setLoadingOrganizationPrograms(false);
  }
};
```

#### 4. ä¿®æ”¹ useEffect è¼‰å…¥é‚è¼¯

**ä½ç½®**: `AssignmentDialog.tsx` Line 322-324

**Before**:

```typescript
if (showSchoolTab) {
  loadSchoolPrograms();
}
```

**After**:

```typescript
if (showOrganizationTab) {
  loadOrganizationPrograms();
}
```

#### 5. ä¿®æ”¹ Tab UI

**ä½ç½®**: `AssignmentDialog.tsx` Line 1220-1250

**Before**:

```tsx
<TabsList
  className={`grid w-full ${showSchoolTab ? "grid-cols-3" : "grid-cols-2"} mb-2`}
>
  <TabsTrigger value="template">
    <Globe className="h-4 w-4" />
    å€‹äººæ•™æ
  </TabsTrigger>
  {showSchoolTab && (
    <TabsTrigger value="school">
      <School className="h-4 w-4" />
      å­¸æ ¡æ•™æ
    </TabsTrigger>
  )}
  <TabsTrigger value="classroom">
    <School className="h-4 w-4" />
    ç­ç´šèª²ç¨‹
  </TabsTrigger>
</TabsList>
```

**After**:

```tsx
<TabsList
  className={`grid w-full ${showOrganizationTab ? "grid-cols-3" : "grid-cols-2"} mb-2`}
>
  <TabsTrigger value="template">
    <Globe className="h-4 w-4" />
    å€‹äººæ•™æ
  </TabsTrigger>
  {showOrganizationTab && (
    <TabsTrigger value="organization">
      <Building2 className="h-4 w-4" />
      æ©Ÿæ§‹æ•™æ
    </TabsTrigger>
  )}
  <TabsTrigger value="classroom">
    <Users className="h-4 w-4" />
    ç­ç´šèª²ç¨‹
  </TabsTrigger>
</TabsList>
```

#### 6. ä¿®æ”¹ TabContent å…§å®¹

**ä½ç½®**: `AssignmentDialog.tsx` Line 1499-1580

**Before**:

```tsx
{showSchoolTab && (
  <TabsContent value="school" className="flex-1 mt-0 overflow-hidden min-h-0">
    <ScrollArea className="h-full border rounded-lg p-3">
      {loadingSchoolPrograms ? (
        // Loading state
      ) : schoolPrograms.length === 0 ? (
        // Empty state
      ) : (
        <div className="space-y-2">
          {schoolPrograms.map((program) => (
            // Program card
          ))}
        </div>
      )}
    </ScrollArea>
  </TabsContent>
)}
```

**After**:

```tsx
{
  showOrganizationTab && (
    <TabsContent
      value="organization"
      className="flex-1 mt-0 overflow-hidden min-h-0"
    >
      <ScrollArea className="h-full border rounded-lg p-3">
        {loadingOrganizationPrograms ? (
          <div className="flex flex-col items-center justify-center h-96">
            <Loader2 className="h-16 w-16 animate-spin text-blue-600 mx-auto" />
            <p className="mt-6 text-lg font-medium text-gray-700">
              è¼‰å…¥æ©Ÿæ§‹æ•™æä¸­...
            </p>
          </div>
        ) : organizationPrograms.length === 0 ? (
          <div className="flex flex-col items-center justify-center h-96">
            <Package className="h-16 w-16 text-gray-300 mb-4" />
            <p className="text-gray-500">å°šç„¡æ©Ÿæ§‹æ•™æ</p>
            <p className="text-sm text-gray-400 mt-2">
              è«‹è¯çµ¡æ©Ÿæ§‹ç®¡ç†å“¡å»ºç«‹å…±äº«æ•™æ
            </p>
          </div>
        ) : (
          <div className="space-y-2">
            {organizationPrograms.map((program) => (
              <Card key={program.id} className="overflow-hidden">
                {/* èˆ‡å€‹äººæ•™æç›¸åŒçš„å‘ˆç¾æ–¹å¼ */}
              </Card>
            ))}
          </div>
        )}
      </ScrollArea>
    </TabsContent>
  );
}
```

#### 7. ä¿®æ”¹ activeTab é¡å‹å®šç¾©

**ä½ç½®**: `AssignmentDialog.tsx` å¤šè™•

**Before**:

```typescript
const [activeTab, setActiveTab] = useState<"template" | "classroom" | "school">(
  "template",
);

setActiveTab(v as "template" | "classroom" | "school");
```

**After**:

```typescript
const [activeTab, setActiveTab] = useState<
  "template" | "classroom" | "organization"
>("template");

setActiveTab(v as "template" | "classroom" | "organization");
```

---

## ğŸ“¦ éœ€è¦æ–°å¢çš„ Props

### WorkspaceContext éœ€æ±‚æª¢æŸ¥

ç¢ºèª `WorkspaceContext` æ˜¯å¦æä¾› `selectedOrganization`:

```typescript
// frontend/src/contexts/WorkspaceContext.tsx
interface WorkspaceContextType {
  selectedOrganization: { id: string; name: string } | null;
  selectedSchool: { id: string; name: string } | null;
  // ...
}
```

å¦‚æœæ²’æœ‰ï¼Œéœ€è¦å¾ `selectedSchool` ä¸­å–å¾—å…¶ `organization_id`:

```typescript
const loadOrganizationPrograms = async () => {
  // å¾ selectedSchool å–å¾— organization_id
  if (!selectedSchool?.organization_id) return;

  try {
    setLoadingOrganizationPrograms(true);
    const response = await apiClient.get<Program[]>(
      `/api/organizations/${selectedSchool.organization_id}/programs`,
    );
    setOrganizationPrograms(response);
  } catch (error) {
    console.error("Failed to load organization programs:", error);
    toast.error("è¼‰å…¥æ©Ÿæ§‹æ•™æå¤±æ•—");
    setOrganizationPrograms([]);
  } finally {
    setLoadingOrganizationPrograms(false);
  }
};
```

---

## ğŸ§ª æ¸¬è©¦è¨ˆåŠƒ

### æ‰‹å‹•æ¸¬è©¦æ¸…å–®

#### 1. åŸºæœ¬åŠŸèƒ½æ¸¬è©¦

- [ ] æ´¾ç™¼ä½œæ¥­æ™‚èƒ½çœ‹åˆ°ã€Œæ©Ÿæ§‹æ•™æã€Tab
- [ ] æ©Ÿæ§‹æ•™æèƒ½æ­£ç¢ºè¼‰å…¥ä¸¦é¡¯ç¤º
- [ ] èƒ½å¾æ©Ÿæ§‹æ•™æä¸­é¸æ“‡å…§å®¹åŠ å…¥è³¼ç‰©è»Š
- [ ] èƒ½æˆåŠŸæ´¾ç™¼æ©Ÿæ§‹æ•™æçš„ä½œæ¥­

#### 2. ä¸åŒæ¨¡å¼æ¸¬è©¦

- [ ] **ä¸€èˆ¬è€å¸«æ¨¡å¼**: ä¸é¡¯ç¤ºæ©Ÿæ§‹æ•™æ Tab (åªæœ‰å€‹äºº+ç­ç´š)
- [ ] **æ©Ÿæ§‹æ¨¡å¼ + æœ‰é¸æ“‡å­¸æ ¡**: é¡¯ç¤ºæ©Ÿæ§‹æ•™æ Tab (å€‹äºº+æ©Ÿæ§‹+ç­ç´š)
- [ ] **æ©Ÿæ§‹æ¨¡å¼ + æœªé¸æ“‡å­¸æ ¡**: ä¸é¡¯ç¤ºæ©Ÿæ§‹æ•™æ Tab

#### 3. Edge Cases

- [ ] æ©Ÿæ§‹ç„¡æ•™ææ™‚é¡¯ç¤ºæ­£ç¢ºçš„ç©ºç‹€æ…‹
- [ ] æ©Ÿæ§‹æ•™æè¼‰å…¥å¤±æ•—æ™‚é¡¯ç¤ºéŒ¯èª¤è¨Šæ¯
- [ ] åˆ‡æ› Tab æ™‚ç‹€æ…‹æ­£ç¢ºä¿ç•™

#### 4. å›æ­¸æ¸¬è©¦

- [ ] å€‹äººæ•™æåŠŸèƒ½æ­£å¸¸
- [ ] ç­ç´šèª²ç¨‹åŠŸèƒ½æ­£å¸¸
- [ ] è³¼ç‰©è»ŠåŠŸèƒ½æ­£å¸¸
- [ ] æ´¾ç™¼ä½œæ¥­æµç¨‹å®Œæ•´

### æ¸¬è©¦ç’°å¢ƒ

```bash
# å•Ÿå‹•é–‹ç™¼ç’°å¢ƒ
cd frontend
npm run dev

# æ¸¬è©¦å¸³è™Ÿéœ€æ±‚ï¼š
# 1. å±¬æ–¼æŸå€‹æ©Ÿæ§‹çš„è€å¸«å¸³è™Ÿ
# 2. è©²æ©Ÿæ§‹è‡³å°‘æœ‰ 1 å€‹å­¸æ ¡
# 3. è©²æ©Ÿæ§‹è‡³å°‘æœ‰ 1 å€‹æ•™æ
```

---

## ğŸ“Š å¯¦æ–½è¨ˆç•«

### é¸é … A: MVP æ–¹æ¡ˆï¼ˆæœ€å°å¯è¡Œï¼‰

**ç¯„åœ**: æ ¸å¿ƒ 3 å€‹ä½ç½®ï¼ˆP0 å„ªå…ˆç´šï¼‰

#### Phase 1: æº–å‚™éšæ®µ (30 åˆ†é˜)

- [x] å®Œæˆå½±éŸ¿è©•ä¼°èˆ‡ç›¤é»
- [ ] ç¢ºèª API ç«¯é» `/api/organizations/{id}/programs` å¯ç”¨
- [ ] ç¢ºèª WorkspaceContext æœ‰ `selectedOrganization`

#### Phase 2: é–‹ç™¼éšæ®µ (2 å°æ™‚)

- [ ] ä¿®æ”¹ `AssignmentDialog.tsx`
  - [ ] æ›´æ–° Tab é¡¯ç¤ºé‚è¼¯ï¼ˆschool â†’ organizationï¼‰
  - [ ] æ›´æ–°ç‹€æ…‹ç®¡ç†
  - [ ] æ›´æ–° API å‘¼å«å‡½æ•¸
  - [ ] æ›´æ–° UI å…ƒä»¶å’Œæ–‡æ¡ˆ
- [ ] ç§»é™¤ `SchoolDetailPage.tsx` ä¸­çš„å­¸æ ¡æ•™ææŒ‰éˆ•
- [ ] æ›´æ–° `sidebarConfig.tsx` å´é‚Šæ¬„é …ç›®

#### Phase 3: æ¸¬è©¦èˆ‡éƒ¨ç½² (30 åˆ†é˜)

- [ ] åŸºæœ¬åŠŸèƒ½æ¸¬è©¦
- [ ] ä¸åŒæ¨¡å¼æ¸¬è©¦
- [ ] æœ¬åœ°é©—è­‰å®Œæˆ

**ç¸½é ä¼°æ™‚é–“**: 3 å°æ™‚

---

### é¸é … B: å®Œæ•´æ–¹æ¡ˆï¼ˆæ¨è–¦ï¼‰

**ç¯„åœ**: å…¨éƒ¨ 7 å€‹ä½ç½®ï¼ˆP0 + P1 + P2ï¼‰

#### Phase 1: æº–å‚™éšæ®µ (30 åˆ†é˜)

- [x] å®Œæˆå½±éŸ¿è©•ä¼°èˆ‡ç›¤é»
- [ ] ç¢ºèª API ç«¯é»å­˜åœ¨ä¸”å¯ç”¨
- [ ] ç¢ºèª WorkspaceContext è³‡æ–™çµæ§‹
- [ ] å»ºç«‹æ¸¬è©¦ç’°å¢ƒèˆ‡æ¸¬è©¦å¸³è™Ÿ

#### Phase 2: æ ¸å¿ƒé–‹ç™¼ (2 å°æ™‚)

**P0 å„ªå…ˆç´š** - å¿…é ˆå®Œæˆ

- [ ] ä¿®æ”¹ `AssignmentDialog.tsx`ï¼ˆæ ¸å¿ƒåŠŸèƒ½ï¼‰
- [ ] ç§»é™¤ `SchoolDetailPage.tsx` ä¸­çš„æŒ‰éˆ•
- [ ] æ›´æ–° `sidebarConfig.tsx`

#### Phase 3: é€£å¸¶ä¿®æ”¹ (1.5 å°æ™‚)

**P1 å„ªå…ˆç´š** - å»ºè­°å®Œæˆ

- [ ] é‡æ§‹æˆ–ç§»é™¤ `SchoolMaterialsPage.tsx`
  - é¸é … A: æ”¹ç‚ºæ©Ÿæ§‹æ•™æé é¢
  - é¸é … B: ç§»é™¤ä¸¦é‡å®šå‘
- [ ] æ›´æ–°è·¯ç”±å®šç¾©
  - [ ] `App.tsx` - ç§»é™¤ `/teacher/school-materials`
  - [ ] `organizationRoutes.tsx` - ç§»é™¤ `schools/:schoolId/materials`
- [ ] æ›´æ–° `TeacherLayout.tsx` éæ¿¾é‚è¼¯

#### Phase 4: æ–‡æ¡ˆæ¸…ç† (30 åˆ†é˜)

**P2 å„ªå…ˆç´š** - å¯é¸å®Œæˆ

- [ ] æ›´æ–° `CreateProgramDialog.tsx` æç¤ºæ–‡å­—
- [ ] æ›´æ–° `ClassroomMaterialsSidebar.tsx` èªªæ˜
- [ ] æ›´æ–° `SchoolProgramCreateDialog.tsx` Toast è¨Šæ¯
- [ ] æ¸…ç† `LessonDialog.tsx` è¨»è§£

#### Phase 5: æ¸¬è©¦èˆ‡éƒ¨ç½² (1 å°æ™‚)

- [ ] åŸ·è¡Œå®Œæ•´æ¸¬è©¦æ¸…å–®ï¼ˆåŸºæœ¬+æ¨¡å¼+Edge Cases+å›æ­¸ï¼‰
- [ ] ä¿®å¾©ç™¼ç¾çš„å•é¡Œ
- [ ] ç¨‹å¼ç¢¼å¯©æŸ¥
- [ ] éƒ¨ç½²åˆ°æ¸¬è©¦ç’°å¢ƒ
- [ ] ä½¿ç”¨è€…é©—æ”¶æ¸¬è©¦ (UAT)

**ç¸½é ä¼°æ™‚é–“**: 5.5 å°æ™‚ï¼ˆç´„ 1 å€‹å·¥ä½œæ—¥ï¼‰

---

### å»ºè­°åŸ·è¡Œæ–¹æ¡ˆ

**æ¨è–¦**: é¸é … Bï¼ˆå®Œæ•´æ–¹æ¡ˆï¼‰âœ…

**ç†ç”±**:

1. æ™‚é–“æˆæœ¬å·®ç•°ä¸å¤§ï¼ˆ3h vs 5.5hï¼‰
2. å¾¹åº•è§£æ±ºå•é¡Œï¼Œç„¡æŠ€è¡“å‚µ
3. é¿å…æœªä¾†ç¶­è­·å›°æ“¾
4. ä½¿ç”¨è€…é«”é©—æ›´ä¸€è‡´

---

## ğŸ¨ UI/UX æ”¹å–„é‡é»

### åœ–ç¤ºé¸æ“‡å»ºè­°

```tsx
import { Building2, Globe, Users } from "lucide-react";

// å€‹äººæ•™æ: Globe (åœ°çƒï¼Œä»£è¡¨è€å¸«å€‹äººçš„ä¸–ç•Œ)
<Globe className="h-4 w-4" />

// æ©Ÿæ§‹æ•™æ: Building2 (å»ºç¯‰ç‰©ï¼Œä»£è¡¨æ©Ÿæ§‹)
<Building2 className="h-4 w-4" />

// ç­ç´šèª²ç¨‹: Users (äººç¾¤ï¼Œä»£è¡¨ç­ç´šå­¸ç”Ÿ)
<Users className="h-4 w-4" />
```

### æ–‡æ¡ˆå„ªåŒ–

| Tab      | åŸæ–‡æ¡ˆ   | æ–°æ–‡æ¡ˆ       | èªªæ˜         |
| -------- | -------- | ------------ | ------------ |
| å€‹äººæ•™æ | å€‹äººæ•™æ | **æˆ‘çš„æ•™æ** | æ›´è¦ªåˆ‡       |
| æ©Ÿæ§‹æ•™æ | -        | **æ©Ÿæ§‹å…±äº«** | å¼·èª¿å…±äº«æ€§è³ª |
| ç­ç´šèª²ç¨‹ | ç­ç´šèª²ç¨‹ | **æœ¬ç­æ•™æ** | æ›´æ˜ç¢º       |

### ç©ºç‹€æ…‹æç¤ºå„ªåŒ–

```tsx
// æ©Ÿæ§‹æ•™æç‚ºç©ºæ™‚
<div className="text-center py-12">
  <Building2 className="h-16 w-16 text-gray-300 mx-auto mb-4" />
  <h3 className="text-lg font-medium text-gray-700 mb-2">å°šç„¡æ©Ÿæ§‹å…±äº«æ•™æ</h3>
  <p className="text-sm text-gray-500 max-w-sm mx-auto">
    æ©Ÿæ§‹æ•™æç”±æ©Ÿæ§‹ç®¡ç†å“¡çµ±ä¸€å»ºç«‹ï¼Œæ‰€æœ‰åˆ†æ ¡çš„è€å¸«éƒ½å¯ä»¥ä½¿ç”¨ã€‚
    å¦‚éœ€å»ºç«‹æ•™æï¼Œè«‹è¯çµ¡æ‚¨çš„æ©Ÿæ§‹ç®¡ç†å“¡ã€‚
  </p>
</div>
```

---

## âš ï¸ æ³¨æ„äº‹é …

### 1. API ç«¯é»ç¢ºèª

ç¢ºèªä»¥ä¸‹ API ç«¯é»å­˜åœ¨ä¸”æ¬Šé™æ­£ç¢ºï¼š

```bash
# æ©Ÿæ§‹æ•™æåˆ—è¡¨
GET /api/organizations/{org_id}/programs

# å›æ‡‰ç¯„ä¾‹
[
  {
    "id": 123,
    "name": "TOEIC å¤šç›Šç¶ è‰²è­‰æ›¸ Part 1",
    "description": "...",
    "organization_id": "uuid",
    "school_id": null,  // æ©Ÿæ§‹æ•™æå¿…é ˆç‚º null
    "is_template": true,
    "lessons": [...]
  }
]
```

### 2. æ¬Šé™æª¢æŸ¥

ç¢ºèªä¸€èˆ¬è€å¸«èƒ½å¦è®€å–æ©Ÿæ§‹æ•™æï¼š

- âœ… æ‡‰è©²å…è¨±: åŒæ©Ÿæ§‹çš„è€å¸«æŸ¥çœ‹æ©Ÿæ§‹æ•™æ
- âŒ æ‡‰è©²ç¦æ­¢: éè©²æ©Ÿæ§‹çš„è€å¸«æŸ¥çœ‹

### 3. è³‡æ–™ä¸€è‡´æ€§

æ©Ÿæ§‹æ•™æçš„ç‰¹å¾µï¼š

```sql
-- æ©Ÿæ§‹æ•™æå¿…é ˆæ»¿è¶³
organization_id IS NOT NULL
AND school_id IS NULL
AND is_template = true
```

### 4. å‘å¾Œç›¸å®¹æ€§

- èˆŠçš„ã€Œå­¸æ ¡æ•™æã€æ•¸æ“šä¾ç„¶ä¿ç•™åœ¨è³‡æ–™åº«
- åªæ˜¯å‰ç«¯ä¸å†é¡¯ç¤ºåœ¨æ´¾ç™¼ä½œæ¥­ä»‹é¢
- æ©Ÿæ§‹ç®¡ç†å“¡ä»å¯åœ¨å¾Œå°ç®¡ç†å­¸æ ¡æ•™æï¼ˆå¦‚æœéœ€è¦ï¼‰

---

## ğŸ”„ æœªä¾†å„ªåŒ–å»ºè­°

### çŸ­æœŸ (1-2 é€±)

1. æ”¶é›†ä½¿ç”¨è€…åé¥‹
2. èª¿æ•´ UI/æ–‡æ¡ˆ
3. å„ªåŒ–è¼‰å…¥æ•ˆèƒ½

### ä¸­æœŸ (1-2 æœˆ)

1. å¦‚æœå­¸æ ¡æ•™æä½¿ç”¨ç‡æŒçºŒç‚º 0ï¼Œè€ƒæ…®å®Œå…¨ç§»é™¤
2. æ–°å¢æ©Ÿæ§‹æ•™æä½¿ç”¨çµ±è¨ˆ
3. æä¾›ã€Œæˆ‘çš„æœ€æ„›ã€æ•™æåŠŸèƒ½

### é•·æœŸ (3-6 æœˆ)

1. å¯¦æ–½æ¨™ç±¤ç³»çµ±ï¼ˆåƒè€ƒåŸè©•ä¼°å ±å‘Šçš„é¸é … Cï¼‰
2. æ”¯æ´è·¨æ©Ÿæ§‹æ•™æå…±äº«ï¼ˆéœ€è¦æ¬Šé™è¨­è¨ˆï¼‰
3. æ•™æå¸‚é›†åŠŸèƒ½

---

## ğŸ“š ç›¸é—œæ–‡ä»¶

- [å®Œæ•´å½±éŸ¿è©•ä¼°å ±å‘Š](./REMOVE_SCHOOL_MATERIALS_IMPACT_ASSESSMENT.md) - å®Œå…¨ç§»é™¤æ–¹æ¡ˆçš„è©•ä¼°
- [æ•™ææ¶æ§‹æ–‡ä»¶](./MATERIALS_ARCHITECTURE.md) - æ•´é«”æ•™æç³»çµ±æ¶æ§‹
- [API æ–‡ä»¶](./API_ORGANIZATION_HIERARCHY.md) - çµ„ç¹”å±¤ç´š API è¦æ ¼

---

## âœ… æ±ºç­–å»ºè­°èˆ‡ç›¤é»ç¸½çµ

### ğŸ“‹ ç›¤é»çµæœç¢ºèª

**ä½¿ç”¨è€…ç›¤é»çš„ 3 å€‹æ ¸å¿ƒä½ç½®** âœ…:

1. âœ… `https://duotopia.co/teacher/classroom/70` > æŒ‡æ´¾æ–°ä½œæ¥­ - æ”¹é¡¯ç¤ºæ©Ÿæ§‹æ•™æ
2. âœ… `https://duotopia.co/organization/schools/{id}` - ä¸é¡¯ç¤ºå­¸æ ¡æ•™ææŒ‰éˆ•
3. âœ… `https://duotopia.co/teacher/dashboard` - å´é‚Šæ¬„ã€Œå­¸æ ¡æ•™æã€æ”¹ç‚ºã€Œæ©Ÿæ§‹æ•™æã€

**ç³»çµ±è£œå……çš„ 4 å€‹é€£å¸¶ä½ç½®**: 4. ğŸŸ¡ å­¸æ ¡æ•™æé é¢é‡æ§‹æˆ–ç§»é™¤ 5. ğŸŸ¡ è·¯ç”±å®šç¾©æ›´æ–°ï¼ˆ2 è™•ï¼‰6. ğŸŸ¡ TeacherLayout éæ¿¾é‚è¼¯ 7. ğŸŸ¢ å…¶ä»–æ–‡æ¡ˆæ¸…ç†

**ç›¤é»ä¸€è‡´æ€§**: âœ… **å®Œå…¨ä¸€è‡´**ï¼Œæ ¸å¿ƒéœ€æ±‚æ˜ç¢ºï¼Œè£œå……é …ç›®åˆç†ã€‚

---

### æ¨è–¦åŸ·è¡Œæ–¹æ¡ˆ

#### ğŸ¯ æ–¹æ¡ˆé¸æ“‡: é¸é … Bï¼ˆå®Œæ•´æ–¹æ¡ˆï¼‰â­â­â­â­â­

**åŸ·è¡Œç¯„åœ**:

- âœ… æ ¸å¿ƒ 3 å€‹ä½ç½®ï¼ˆä½¿ç”¨è€…ç›¤é»ï¼‰
- âœ… é€£å¸¶ 4 å€‹ä½ç½®ï¼ˆç³»çµ±è£œå……ï¼‰
- âœ… æ–‡æ¡ˆæ¸…ç†å„ªåŒ–

**é ä¼°æ™‚é–“**: 5.5 å°æ™‚ï¼ˆ1 å€‹å·¥ä½œæ—¥å…§å®Œæˆï¼‰

**å„ªå‹¢**:

1. å¾¹åº•è§£æ±ºå•é¡Œï¼Œç„¡æŠ€è¡“å‚µ
2. æ™‚é–“æˆæœ¬å¯æ§ï¼ˆ< 1 å¤©ï¼‰
3. ä½¿ç”¨è€…é«”é©—ä¸€è‡´æ€§æœ€ä½³
4. é¿å…æœªä¾†ç¶­è­·å›°æ“¾

---

### å¯¦æ–½æ­¥é©Ÿå»ºè­°

#### ç¬¬ä¸€æ­¥: ç«‹å³åŸ·è¡Œå‰ç«¯ç°¡åŒ–ï¼ˆæœ¬é€±å®Œæˆï¼‰â­â­â­â­â­

- åŸ·è¡Œå®Œæ•´æ–¹æ¡ˆï¼ˆ7 å€‹ä½ç½®ï¼‰
- å¿«é€Ÿæ”¹å–„ä½¿ç”¨è€…é«”é©—
- é›¶å¾Œç«¯é¢¨éšª
- ç«‹å³è¦‹æ•ˆ

#### ç¬¬äºŒæ­¥: è§€å¯Ÿä½¿ç”¨æƒ…æ³ï¼ˆ1-2 å€‹æœˆï¼‰

- çµ±è¨ˆæ©Ÿæ§‹æ•™æä½¿ç”¨ç‡
- æ”¶é›†ä½¿ç”¨è€…åé¥‹
- ç›£æ§èˆŠå­¸æ ¡æ•™æè¨ªå•é‡
- è©•ä¼°æ˜¯å¦éœ€è¦é€²ä¸€æ­¥èª¿æ•´

#### ç¬¬ä¸‰æ­¥: åŸºæ–¼æ•¸æ“šæ±ºå®šï¼ˆ2-3 å€‹æœˆå¾Œï¼‰

- å¦‚æœå­¸æ ¡æ•™æä½¿ç”¨ç‡ = 0 â†’ è€ƒæ…®å®Œå…¨ç§»é™¤å¾Œç«¯
- å¦‚æœæœ‰ç‰¹æ®Šéœ€æ±‚ â†’ è€ƒæ…®æ¨™ç±¤ç³»çµ±æ–¹æ¡ˆ
- å¦‚æœç¾æ³è‰¯å¥½ â†’ ç¶­æŒç¾ç‹€

---

### æˆåŠŸæŒ‡æ¨™

**çŸ­æœŸæŒ‡æ¨™ï¼ˆ1 é€±å…§ï¼‰**:

- [ ] æ‰€æœ‰æ ¸å¿ƒåŠŸèƒ½æ­£å¸¸é‹ä½œ
- [ ] ç„¡ä½¿ç”¨è€…æŠ•è¨´æˆ–éŒ¯èª¤å›å ±
- [ ] æ©Ÿæ§‹æ•™æè¼‰å…¥é€Ÿåº¦ < 2 ç§’

**ä¸­æœŸæŒ‡æ¨™ï¼ˆ1 å€‹æœˆå…§ï¼‰**:

- [ ] æ©Ÿæ§‹æ•™æä½¿ç”¨ç‡ > 70%
- [ ] ä½¿ç”¨è€…æ»¿æ„åº¦èª¿æŸ¥ > 4/5
- [ ] å­¸æ ¡æ•™æèˆŠè·¯ç”±è¨ªå•é‡ < 5%

**é•·æœŸæŒ‡æ¨™ï¼ˆ3 å€‹æœˆå…§ï¼‰**:

- [ ] æ©Ÿæ§‹æ•™ææˆç‚ºä¸»è¦é¸æ“‡
- [ ] æ•™æç®¡ç†æ•ˆç‡æå‡
- [ ] æ±ºå®šæ˜¯å¦å®Œå…¨ç§»é™¤å­¸æ ¡æ•™æ

---

**è©•ä¼°è€…**: GitHub Copilot  
**ç›¤é»æ—¥æœŸ**: 2026-02-10  
**æ–¹æ¡ˆç‹€æ…‹**: âœ… **é›™æ–¹ç›¤é»ä¸€è‡´ï¼Œå¼·çƒˆæ¨è–¦ç«‹å³åŸ·è¡Œ**  
**é ä¼°å®Œæˆ**: 1 å€‹å·¥ä½œæ—¥å…§
