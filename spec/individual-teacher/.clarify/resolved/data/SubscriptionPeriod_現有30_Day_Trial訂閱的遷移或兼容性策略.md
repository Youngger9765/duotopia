# 釐清問題

已有 30-Day Trial 訂閱的用戶在此次部署後，其現有訂閱是否有任何變化？是否支持用戶自行轉換方案？

# 定位

**Entity:** SubscriptionPeriod  
**Relationships：** 與 Teacher 的 1:N 關係（一個用戶可有多個訂閱週期）  
**Scenario：** 現有用戶的向後相容性

相關規格位置：  
[FEATURE_SPEC_POINT_BASED_TRIAL.md](../../features/subscription/FEATURE_SPEC_POINT_BASED_TRIAL.md#L118)（「現有用戶不受影響」測試項）

# 多選題

| 選項  | 描述                                          |
| ----- | --------------------------------------------- |
| A     | 完全保留 - 現有訂閱完全不變，新方案僅針對新戶 |
| B     | 迁移所有 - 所有現有 30-Day Trial 自動轉換     |
| C     | 迁移過期的 - 只轉換已過期的 30-Day Trial      |
| D     | 自願轉換 - 在 UI 提供「轉換到新方案」按鈕     |
| E     | 分組轉換 - 按建立時間分批轉換                 |
| Short | 其他（請說明）                                |

# 影響範圍

- **資料層：**
  - Migration 腳本（如需批量更新）
  - Seed 數據邏輯
  - 資料驗證與完整性檢查
- **後端邏輯：**
  - 訂閱查詢邏輯（區分舊方案與新方案的場景）
  - Admin 後台顯示邏輯
- **前端邏輯：**
  - 方案對比頁面
  - 用戶帳戶頁面
- **測試案例：**
  - 向後相容性測試
  - 資料遷移驗證測試

# 優先級

**High** - 此決策影響：

- 資料一致性（現有訂閱記錄完整性）
- 用戶體驗連續性（是否有感知上的變化）
- 業務邏輯（現有用戶是否失去權益）
- 部署風險（需要決定是否執行 migration）

# 備註

規格明確說明 "現有 30-Day Trial 訂閱保持不變"，但 **「保持不變」是指什麼** 需要進一步釐清：

1. **字面理解：** 不修改任何已存在的 SubscriptionPeriod 記錄
2. **功能理解：** 用戶仍可繼續使用現有訂閱，新方案不涉及現有用戶

建議確認此理解是否正確，以及是否有例外情況（如某個支持團隊請求轉換）。

# 補充信息

根據 discovery.md 檢查清單 B3（例子覆蓋度），規格中應明確涵蓋以下場景的 Example：

- 新用戶首次註冊 ✅（已涵蓋）
- 現有 30-Day Trial 用戶的行為 ❓（未明確）
- 已過期試用用戶的處理 ❓（未明確）

---

# 解決記錄

- **回答**：B - 遷移所有 - 所有現有 30-Day Trial 自動轉換為 Point-Based Trial
- **更新的規格檔**：spec/individual-teacher/features/subscription/FEATURE_SPEC_POINT_BASED_TRIAL.md
- **變更內容**：
  - 新增「遷移現有 30-Day Trial 訂閱」到範圍說明
  - 新增修改檔案 4：資料遷移腳本 `migrate_30day_trial_to_point_based.py`
  - 更新集成測試：新增資料遷移測試案例
  - 更新驗收標準：新增 migration 相關驗收項目
  - 更新影響範圍：標記資料遷移與現有訂閱記錄受影響
  - 更新風險評估：從低風險調整為中風險（資料遷移），並補充緩解措施
  - 更新實作 Checklist：新增 migration 相關步驟
