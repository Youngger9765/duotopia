# 釐清問題

機構簽約時，合約編號的生成規則是什麼？

# 定位

Feature：`spec/features/subscription/機構簽約與付款.feature` - 規則「建立機構合約」
ERM：`spec/erm-subscription.dbml` - Table `contracts` - 欄位 `contract_number`

# 多選題

| 選項  | 描述                                                  |
| ----- | ----------------------------------------------------- |
| A     | 時間戳 + 機構代碼（如：20260107-ABC001）              |
| B     | 流水號（如：CTR-000001）                              |
| C     | UUID 格式（如：550e8400-e29b-41d4-a716-446655440000） |
| D     | 機構代碼 + 年份 + 序號（如：ABC-2026-001）            |
| Short | 提供其他簡短答案（<=5 字）                            |

# 影響範圍

- 影響 `contracts.contract_number` 的生成邏輯
- 影響合約編號的可讀性與唯一性保證
- 影響合約查詢與搜尋功能

# 優先級

Low

理由：

- Feature 提到「合約編號應自動生成」
- 但未定義具體格式
- 不影響核心業務邏輯
- 屬於實作細節，可在開發階段決定

---

# 解決方案（決策 #5）

**決策日期**: 2026-01-09

**答案**: 架構調整 - 改為選填欄位

**說明**:

- contract_files.contract_number 改為選填
- 由專案人員手動填寫（如紙本合約上的編號）
- 系統不自動生成合約編號
- 主要用於搜尋與查詢

**相關更新**:

- ✅ erm-subscription.dbml: contract_files.contract_number 設為 null
- ✅ 新建「專案人員開立機構訂閱.feature」

**參考**: 架構重大調整決策.md
