# 釐清問題

機構簽約時，如果付款失敗後重試，合約編號是否重新生成？

# 定位

Feature：`spec/features/subscription/機構簽約與付款.feature` - 規則「建立機構合約」與「處理付款」

# 多選題

| 選項  | 描述                                 |
| ----- | ------------------------------------ |
| A     | 保留原合約編號，更新付款記錄         |
| B     | 取消原合約，重新建立新合約（新編號） |
| C     | 保留原合約，建立新的付款記錄         |
| D     | 依付款方式不同而異                   |
| Short | 提供其他簡短答案（<=5 字）           |

# 影響範圍

- 影響合約與付款的關聯關係 (1:1 vs 1:N)
- 影響失敗後重試的業務流程
- 影響 `contracts` 和 `payments` 表的關聯規則

# 優先級

High

理由：

- 目前 DBML 定義 `contract_id` 1:N `payments`（一個合約可有多筆付款）
- 但 Feature 未涵蓋付款失敗重試的場景
- 需明確定義失敗處理流程
- 影響錯誤處理邏輯

---

# 解決方案（決策 #6）

**決策日期**: 2026-01-09

**答案**: 架構調整 - 無線上付款流程

**說明**:

- 付款為線下處理，無失敗重試場景
- 專案人員記錄的是已完成的付款
- 如需修正付款資訊，直接編輯記錄

**相關更新**:

- ✅ 移除線上付款狀態管理
- ✅ 新建「專案人員開立機構訂閱.feature」

**參考**: 架構重大調整決策.md
