# 釐清問題

點數加購後，如果付款失敗，加購記錄的狀態如何處理？

# 定位

Feature：`spec/features/subscription/點數加購.feature` - 規則「加購失敗處理」

# 多選題

| 選項  | 描述                               |
| ----- | ---------------------------------- |
| A     | 保持 'pending'，可重新付款         |
| B     | 變更為 'failed'，不可再使用        |
| C     | 變更為 'cancelled'，需重新建立加購 |
| D     | 自動刪除該加購記錄                 |
| Short | 提供其他簡短答案（<=5 字）         |

# 影響範圍

- 影響 `points_purchases.status` 的狀態轉換規則
- 影響加購失敗後的使用者體驗
- 影響付款重試邏輯

# 優先級

High

理由：

- Feature 定義「付款失敗時，加購狀態應保持 'pending'」
- 但未定義：
  - 可以保持 pending 多久？
  - 是否有重試次數限制？
  - 何時應該取消該加購？
- 影響錯誤處理流程

---

# 解決記錄

- **回答**：當天可多次嘗試重新付款，隔日需重新下單，原加購記錄標記為已取消
- **更新的規格檔**：spec/features/subscription/點數加購.feature
- **變更內容**：新增「加購失敗處理」規則，明確定義當天可多次嘗試付款，隔日需重下單，原加購記錄標記為已取消。
