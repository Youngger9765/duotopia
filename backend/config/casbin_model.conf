# Casbin RBAC Model with Domains (Multi-tenant)
# 用於 Duotopia 機構層級權限管理

[request_definition]
# r = subject (teacher_id), domain (org/school), object (resource), action (read/write)
r = sub, dom, obj, act

[policy_definition]
# p = subject (role), domain (org/school), object (resource), action (read/write)
p = sub, dom, obj, act

[role_definition]
# g = user, role, domain
# 例如：g, teacher123, org_owner, org-uuid-abc
# 表示 teacher123 在 org-uuid-abc 有 org_owner 角色
g = _, _, _

[policy_effect]
e = some(where (p.eft == allow))

[matchers]
# 匹配邏輯：
# 1. 檢查使用者在該 domain 是否有該 role
# 2. 檢查 domain 是否匹配（支援 wildcard *）
# 3. 檢查 resource 和 action 是否匹配
m = g(r.sub, p.sub, r.dom) && (r.dom == p.dom || p.dom == "*") && r.obj == p.obj && r.act == p.act
