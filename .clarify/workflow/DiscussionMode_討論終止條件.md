# 釐清問題

討論階段應該在何時終止？終止條件應該如何定義？

# 定位

discussion.md：討論階段規則，目前未定義討論的終止條件，可能導致討論無限循環或過早結束。

# 多選題

| 選項 | 描述                                                                              |
| ---- | --------------------------------------------------------------------------------- |
| A    | 當雙方達成共識（用戶明確選擇某個方案）時終止討論                                  |
| B    | 當 AI 提供建議後、用戶未提出新問題時終止討論                                      |
| C    | 設定討論回合上限（例如：最多 5 輪討論），超過後必須做出決定或明確延長討論         |
| D    | 混合模式：達成共識即終止，但若連續 3 輪無新進展則提醒用戶是否要結束討論或轉換方向 |
| E    | 無固定終止條件，完全由用戶控制何時結束討論進入執行階段                            |

# 影響範圍

- 討論效率（避免無限循環）
- 用戶體驗（避免討論過長或過短）
- discussion.md 需新增「討論終止條件」章節
- 與執行階段觸發條件的銜接（討論結束 → 執行開始）
- AI 在討論過程中的自我檢查機制

# 優先級

High

---

# 解決記錄

- **回答**：D - 混合模式：達成共識即終止，但若連續 3 輪無新進展則提醒用戶

- **說明**：

  **主要終止條件：達成共識**

  - 當用戶明確選擇某個方案時，討論自動終止
  - 選擇方案後進入執行階段（依照執行觸發條件）

  **輔助終止機制：進展監控**

  - AI 自動追蹤討論進展
  - 若連續 3 輪對話沒有新的資訊或決策進展
  - AI 應主動提醒用戶：
    - 「我們已經討論了 X 輪，是否需要：
      A. 結束討論，基於現有資訊做決定
      B. 轉換討論方向或重新聚焦問題
      C. 繼續深入探討目前的方向」

  **彈性控制**

  - 用戶可隨時使用執行觸發詞結束討論進入實作
  - 用戶可明確要求「繼續討論」延長對話
  - 討論過程中若發現新問題可開啟新的討論循環

- **更新的規格檔**：docs/references/bdd-prompts/basic/discussion.md
- **變更內容**：新增「討論終止條件」章節，定義共識終止和進展監控機制
